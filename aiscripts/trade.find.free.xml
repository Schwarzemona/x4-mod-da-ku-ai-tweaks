<?xml version='1.0' encoding='utf-8'?>
<diff>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_all[@exact='$sellspaces.count']/do_if[@value='$buyoffers.count']/do_elseif[@value='$bestbuyoffers.keys.count gt 0 and this.ship.cargo.count gt 0']/do_if[@value='$tempbuyoffers.count']/set_value[@name='$randomindex'][@min='1'][@max='$sorted_offers.count']">
    <sort_trades tradelist="$tempbuyoffers" name="$sorted_offers" sorter="relativeprice"/>
  </replace>
  <add sel="/aiscript/attention[@min='unknown']/actions/do_all[@exact='$sellspaces.count']/do_if[@value='$buyoffers.count']/do_elseif[@value='$bestbuyoffers.keys.count gt 0 and this.ship.cargo.count gt 0']/do_if[@value='$tempbuyoffers.count']/set_value[@name='$buyoffer'][@exact='$sorted_offers.{$randomindex}']" pos="before">
    <set_value name="$randomindex" exact="$sorted_offers.count" comment="no longer random, take the best trade"/>
  </add>
</diff>
