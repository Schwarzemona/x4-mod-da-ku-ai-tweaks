<?xml version="1.0" encoding="utf-8" ?>
<diff>
<!-- replace and add. purpose: recall subordinates only if gatedistance is 2 or more. or in the case of non-fighters 1 or more.
	<param name="recallsubordinates" default="true" type="internal" comment="recall subordinates and cancel the recall of subordinates. disabled in the move.generic call from move.gate"/>
-->
	<replace sel="//params/param[@name=&quot;recallsubordinates&quot;]">
		<param name="recallsubordinates" default="
			if this.assignedcontrolled.primarypurpose == purpose.mine then true
			else (
				if this.assignedcontrolled.primarypurpose != purpose.fight then
					if this.assignedcontrolled.jobmainsector and this.assignedcontrolled.gatedistance.{this.assignedcontrolled.jobmainsector} ge 1 then true
					else (
						if @$destination.count then
							if this.assignedcontrolled.gatedistance.{$destination.{1}} ge 1 then true
							else false
						else (
							if this.assignedcontrolled.gatedistance.{$destination} ge 1 then true
							else false
						)
					)
				else (
					if this.assignedcontrolled.jobmainsector and this.assignedcontrolled.gatedistance.{this.assignedcontrolled.jobmainsector} ge 2 then true
					else (
						if @$destination.count then
							if this.assignedcontrolled.gatedistance.{$destination.{1}} ge 2 then true
							else false
						else (
							if this.assignedcontrolled.gatedistance.{$destination} ge 2 then true
							else false
						)
					)
				)
			)
		" type="internal" />
	</replace>
<!-- add. purpose: params.
	<params>
-->
	<add sel="//params">
		<param name="kAAITParam_iskAAITOrder" required="false" default="false" type="internal" />
		<param name="kAAITParam_tacticalOrderTarget" required="false" default="null" type="internal" />
		<param name="kAAITParam_isAvoidHighRisk" required="false" type="bool" text="{1111920, 3}" default="
			if (not this.assignedcontrolled.isunit) and (not this.assignedcontrolled.islasertower) and
			(
				(
					this.assignedcontrolled.isplayerowned and
					(this.assignedcontrolled.isclass.[class.ship_xs, class.ship_s, class.ship_m] or this.assignedcontrolled.primarypurpose != purpose.fight) and
					@global.$kAAIT_Data.$xssm_isAvoidHighRisk and
					(
						(not global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$kAAIT_isAvoidHighRisk_user?) or
						@global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$kAAIT_isAvoidHighRisk_user
					)
				) or
				(
					(not this.assignedcontrolled.isplayerowned) and
					(this.assignedcontrolled.isclass.[class.ship_xs, class.ship_s, class.ship_m] or this.assignedcontrolled.primarypurpose != purpose.fight) and
					@global.$kAAIT_Data.$xssm_isAvoidHighRisk_allFactions
				) or
				(
					this.assignedcontrolled.isplayerowned and
					this.assignedcontrolled.isclass.[class.ship_l, class.ship_xl] and
					(@global.$kAAIT_Data.$lxl_isAvoidHighRisk_vShip or @global.$kAAIT_Data.$lxl_isAvoidHighRisk_vStation) and
					(
						(not global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$kAAIT_isAvoidHighRisk_user?) or
						@global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$kAAIT_isAvoidHighRisk_user
					)
				) or
				(
					(not this.assignedcontrolled.isplayerowned) and
					this.assignedcontrolled.isclass.[class.ship_l, class.ship_xl] and
					(@global.$kAAIT_Data.$lxl_isAvoidHighRisk_vShip_allFactions or @global.$kAAIT_Data.$lxl_isAvoidHighRisk_vStation_allFactions)
				)
			) then true else false
		" />
	</add>
<!-- add before. purpose: show movement.
	<location object="$destination" position="$position" condition="$destination and $position"/>
-->
	<add pos="before" sel="//location[@object=&quot;$destination&quot;][@position=&quot;$position&quot;][@condition=&quot;$destination and $position&quot;]">
		<location object="@global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$attackData.$orderLocation_space" position="@global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$attackData.$orderLocation_pos" condition="@global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$attackData.$orderLocation_space and @global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$attackData.$orderLocation_pos" />
	</add>
<!-- add before at 5 instances. purpose: debug.
	<move_to>
-->
	<add pos="before" sel="(//move_to)[1]">
		<debug_text text="@this.assignedcontrolled.idcode + ' move_to (move away from exit gate) $kAAITParam_iskAAITOrder: ' + @$kAAITParam_iskAAITOrder + ' $kAAITParam_isAvoidHighRisk:' + @$kAAITParam_isAvoidHighRisk" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0"/>
	</add>
	<add pos="before" sel="(//move_to)[2]">
		<debug_text text="@this.assignedcontrolled.idcode + ' move_to (move to destination and position) $kAAITParam_iskAAITOrder: ' + @$kAAITParam_iskAAITOrder + ' $kAAITParam_isAvoidHighRisk:' + @$kAAITParam_isAvoidHighRisk" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0"/>
	</add>
	<add pos="before" sel="(//move_to)[3]">
		<debug_text text="@this.assignedcontrolled.idcode + ' move_to (move to destination) $kAAITParam_iskAAITOrder: ' + @$kAAITParam_iskAAITOrder + ' $kAAITParam_isAvoidHighRisk:' + @$kAAITParam_isAvoidHighRisk" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0"/>
	</add>
	<add pos="before" sel="(//move_to)[4]">
		<debug_text text="@this.assignedcontrolled.idcode + ' move_to (small move to final with rotation) $kAAITParam_iskAAITOrder: ' + @$kAAITParam_iskAAITOrder + ' $kAAITParam_isAvoidHighRisk:' + @$kAAITParam_isAvoidHighRisk" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0"/>
	</add>
	<add pos="before" sel="(//move_to)[5]">
		<debug_text text="@this.assignedcontrolled.idcode + ' move_to (small move to final) $kAAITParam_iskAAITOrder: ' + @$kAAITParam_iskAAITOrder + ' $kAAITParam_isAvoidHighRisk:' + @$kAAITParam_isAvoidHighRisk" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0"/>
	</add>
<!--
	add after. purpose: debug.
	<label name="start"/>
	<label name="check" />
	<label name="move" />
	<label name="finish"/>
	<label name="cleanup"/>
-->
	<add pos="after" sel="//label[@name=&quot;start&quot;]">
		<debug_text text="@this.assignedcontrolled.idcode + ' LABEL start $kAAITParam_iskAAITOrder: ' + @$kAAITParam_iskAAITOrder + ' $kAAITParam_isAvoidHighRisk:' + @$kAAITParam_isAvoidHighRisk" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0"/>
	</add>
	<add pos="after" sel="//label[@name=&quot;check&quot;]">
		<debug_text text="@this.assignedcontrolled.idcode + ' LABEL check $kAAITParam_iskAAITOrder: ' + @$kAAITParam_iskAAITOrder + ' $kAAITParam_isAvoidHighRisk:' + @$kAAITParam_isAvoidHighRisk" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0"/>
	</add>
	<add pos="after" sel="//label[@name=&quot;move&quot;]">
		<debug_text text="@this.assignedcontrolled.idcode + ' LABEL move $kAAITParam_iskAAITOrder: ' + @$kAAITParam_iskAAITOrder + ' $kAAITParam_isAvoidHighRisk:' + @$kAAITParam_isAvoidHighRisk" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0"/>
	</add>
	<add pos="after" sel="//label[@name=&quot;cleanup&quot;]">
		<debug_text text="@this.assignedcontrolled.idcode + ' LABEL cleanup $kAAITParam_iskAAITOrder: ' + @$kAAITParam_iskAAITOrder + ' $kAAITParam_isAvoidHighRisk:' + @$kAAITParam_isAvoidHighRisk" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0"/>
	</add>
<!-- add. purpose: withdraw handler.
	<interrupts>
-->
	<add pos="prepend" sel="//interrupts">
		<handler ref="kAAIT_Handler_AvoidWithdrawOrJustFight" />
		<handler ref="kAAIT_Handler_TacticalSubordinateAttack" />
	</add>
<!-- add.
	<init>
-->
	<add sel="//init">
		<do_if value="@$kAAITParam_tacticalOrderTarget.isoperational">
			<debug_text text="@this.assignedcontrolled.idcode + ' LABEL init'" chance="if @this.assignedcontrolled.idcode == @global.$kAAIT.$debugChance_idCode or @global.$kAAIT.$debugChance_idCode == 'all' then @global.$kAAIT_Data.$debugChance else 0" />
			<create_position name="$kAAIT_pos_tacticatTarget" space="$kAAITParam_tacticalOrderTarget.zone" value="$kAAITParam_tacticalOrderTarget.position" />
		</do_if>
	</add>
<!-- add after. purpose: check start avoid. i.e. gravidar events sometimes not soon enough if already near a big enemy -->
	<add pos="after" sel="//label[@name=&quot;start&quot;]">
		<do_if value="@$kAAITParam_isAvoidHighRisk and (not @global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$attackData.$isIgnoreKAAIT)">
			<wait exact="0.5s" />
			<include_interrupt_actions ref="kAAIT_AvoidOrNot" />
			<do_if value="@$kAAIT_result_avoidEnemy.isoperational">
				<do_if value="not global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$attackData?">
					<include_interrupt_actions ref="kAAIT_Init" />
				</do_if>
				<set_value name="global.$kAAITByShipId.{'$' + @this.assignedcontrolled.idcode}.$attackData.$target_avoid" exact="$kAAIT_result_avoidEnemy" />
				<include_interrupt_actions ref="kAAIT_Order_Avoid" />
			</do_if>
		</do_if>
	</add>
<!-- add after. purpose: cleanup.
	<label name="cleanup" />
-->
	<add pos="after" sel="//label[@name=&quot;cleanup&quot;]">
		<include_interrupt_actions ref="kAAIT_Deinit" />
	</add>
<!-- add. purpose: clean-up.
	<on_abort>
-->
	<add sel="//on_abort">
		<include_interrupt_actions ref="kAAIT_Deinit" />
	</add>
	<!-- DeadAir Diffs -->
	<add sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_if[@value='$recallsubordinates and this.assignedcontrolled.subordinates.count and (@this.assignedcontrolled.order.state != orderstate.critical) and not this.$recalling_subordinates? and (not this.isplayerowned or not $loctargetzone or ($loctargetzone != this.zone and not this.zone.adjacentzones.indexof.{$loctargetzone}))']/do_for_each[@name='$locsub']/do_if[@value='$locsub.isoperational and this.assignedcontrolled.dockingallowed.{$locsub} and (not $locsub.dock or not $locsub.hascontext.{this.assignedcontrolled})']" pos="before">
		<do_if value="$locsub.isoperational and this.assignedcontrolled.dockingallowed.{$locsub} and (not $locsub.dock or not $locsub.hascontext.{this.assignedcontrolled})" chance="(not global.$DATTravelTweaks) * 100">
			<set_value name="$recall"/>
			<break/>
		</do_if>
	</add>
	<replace sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_if[@value='$recallsubordinates and this.assignedcontrolled.subordinates.count and (@this.assignedcontrolled.order.state != orderstate.critical) and not this.$recalling_subordinates? and (not this.isplayerowned or not $loctargetzone or ($loctargetzone != this.zone and not this.zone.adjacentzones.indexof.{$loctargetzone}))']/do_for_each[@name='$locsub']/do_if[@value='$locsub.isoperational and this.assignedcontrolled.dockingallowed.{$locsub} and (not $locsub.dock or not $locsub.hascontext.{this.assignedcontrolled})'][2]/@value">$locsub.isoperational and this.assignedcontrolled.dockingallowed.{$locsub} and (not $locsub.dock or not $locsub.hascontext.{this.assignedcontrolled}) and (((@$locsub.formationleader == this.assignedcontrolled) and ([assignment.defence,assignment.attack,assignment.interception,assignment.supplyfleet,assignment.follow].indexof.{@$locsub.assignment})) or ((['Escort','SupplyFleet','ProtectShip','Follow'].indexof.{@$locsub.order.id}) and (@$locsub.order.$target == this.assignedcontrolled)) or (@$locsub.order.$destination == this.assignedcontrolled))</replace>
	<add sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_if[@value='$recallsubordinates and this.assignedcontrolled.subordinates.count and (@this.assignedcontrolled.order.state != orderstate.critical) and not this.$recalling_subordinates? and (not this.isplayerowned or not $loctargetzone or ($loctargetzone != this.zone and not this.zone.adjacentzones.indexof.{$loctargetzone}))']/do_for_each[@name='$locsub']/do_if[2]" type="@chance">global.$DATTravelTweaks * 100</add>
	<add sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_for_each[@name='$locship']/do_if" pos="before">
		<do_if value="$locship.isoperational and (not $locship.dock or not $locship.hascontext.{this.assignedcontrolled}) and ((@$locship.formationleader == this.assignedcontrolled) or ((@$locship.order.id == 'Escort' or @$locship.order.id == 'SupplyFleet') and ($locship.order.$target == this.assignedcontrolled)))" chance="(not global.$DATTravelTweaks) * 100">
			<set_value name="$waitforsubordinates"/>
			<break/>
		</do_if>
	</add>
	<replace sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_for_each[@name='$locship']/do_if[2]/@value">$locship.isoperational and (not $locship.dock or not $locship.hascontext.{this.assignedcontrolled}) and (((@$locship.formationleader == this.assignedcontrolled) and ([assignment.defence,assignment.attack,assignment.interception,assignment.supplyfleet,assignment.follow].indexof.{@$locship.assignment})) or ((['Escort','SupplyFleet','ProtectShip','Follow'].indexof.{@$locship.order.id}) and ($locship.order.$target == this.assignedcontrolled)))</replace>
	<add sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_for_each[@name='$locship']/do_if[2]" type="@chance">global.$DATTravelTweaks * 100</add>
	<add sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_if[@value='$intersector? and not @this.zone.isclass.highway and (@$waitforsubordinates or $waitforatgate or this.assignedcontrolled.iscapitalship)']/do_if[@value='not $waitforsubordinates? and not $waitforatgate.isoperational and not this.zone.isclass.highway']/get_safe_pos[@object='this.assignedcontrolled']" type="@chance">(not global.$DATTravelTweaks) * 100</add>
	<add sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_if[@value='$intersector? and not @this.zone.isclass.highway and (@$waitforsubordinates or $waitforatgate or this.assignedcontrolled.iscapitalship)']/do_if[@value='not $waitforsubordinates? and not $waitforatgate.isoperational and not this.zone.isclass.highway']/move_to[@object='this.assignedcontrolled']" type="@chance">(not global.$DATTravelTweaks) * 100</add>
	<add sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_if[@value='$intersector? and not @this.zone.isclass.highway and (@$waitforsubordinates or $waitforatgate or this.assignedcontrolled.iscapitalship)']/do_if[@value='not $waitforsubordinates? and not $waitforatgate.isoperational and not this.zone.isclass.highway']/remove_value[@name='$safepos']" pos="before">
		<get_safe_pos result="$safepos" zone="this.zone" object="this.assignedcontrolled" direction="quadrant.front" radius="this.assignedcontrolled.size / 2" angle="15deg" chance="global.$DATTravelTweaks * 100"/>
	</add>
	<add sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_if[@value='$intersector? and not @this.zone.isclass.highway and (@$waitforsubordinates or $waitforatgate or this.assignedcontrolled.iscapitalship)']/do_if[@value='not $waitforsubordinates? and not $waitforatgate.isoperational and not this.zone.isclass.highway']/remove_value[@name='$safepos']" pos="before">
		<move_to endzone="$locendzone" object="this.assignedcontrolled" destination="this.zone" uselocalhighways="false" finishonapproach="true" abortpath="true" commandaction="$changecommandaction" chance="global.$DATTravelTweaks * 100">
			<position value="$safepos"/>
			<interrupt_after_time time="2s"/>
		</move_to>
	</add>
	<replace sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_else/wait/@max">if global.$DATTravelTweaks then 500ms else ((not $bigship) * (5.1 - (this.ship.pilot.skill.piloting / 3))s)</replace>
	<replace sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_else/do_if[@value='$position']/move_to[@object='this.ship']/@travel">(global.$DATTravelTweaks) or ((not global.$DATTravelTweaks) and (not $noboost))</replace>
	<replace sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_else/do_else/move_to[@object='this.ship']/@travel">(global.$DATTravelTweaks) or ((not global.$DATTravelTweaks) and (not $noboost))</replace>
	<replace sel="/aiscript/attention/actions/do_if[@value='this.sector != $targetsector or (this.zone != $targetzone and (not @$endzone or this.zone != $endzone) and ($endintargetzone or @$targetzone.isclass.highway or this.ship.bboxdistanceto.[$positionspace, $position, $destination] gt 10km))']/do_else/do_else/move_to[@object='this.ship']/@radius">if global.$DATTravelTweaks then (5km + this.assignedcontrolled.size) else 10km + this.assignedcontrolled.size</replace>
	<add sel="/aiscript/attention/actions/do_if[@value='not @$rotation']/do_if[@value='this.ship.distanceto.[$positionspace, $safepos] gt this.ship.size']/move_to[@object='this.ship']" pos="before">
		<move_to endzone="$locendzone" object="this.ship" destination="$positionspace" uselocalhighways="$canuselocalhighways" abortpath="$abortpath" forcesteering="(not $bigship) and $forcesteering" forceposition="false" forcerotation="false" finishonapproach="false" commandaction="$changecommandaction" chance="(not global.$DATTravelTweaks) * 100">
			<position value="$safepos"/>
		</move_to>
	</add>
	<add sel="/aiscript/attention/actions/do_if[@value='not @$rotation']/do_if[@value='this.ship.distanceto.[$positionspace, $safepos] gt this.ship.size']/move_to[@object='this.ship'][@destination='$positionspace'][@abortpath='$abortpath'][@endzone='$locendzone'][@forcesteering='(not $bigship) and $forcesteering'][@forceposition='false'][@forcerotation='false'][@commandaction='$changecommandaction'][@uselocalhighways='$canuselocalhighways'][@finishonapproach='false'][2]" type="@travel">this.assignedcontrolled.distanceto.[$positionspace, $safepos] gt 10km</add>
	<add sel="/aiscript/attention/actions/do_if[@value='not @$rotation']/do_if[@value='this.ship.distanceto.[$positionspace, $safepos] gt this.ship.size']/move_to[@object='this.ship'][@destination='$positionspace'][@abortpath='$abortpath'][@endzone='$locendzone'][@forcesteering='(not $bigship) and $forcesteering'][@forceposition='false'][@forcerotation='false'][@commandaction='$changecommandaction'][@travel='this.assignedcontrolled.distanceto.[$positionspace, $safepos] gt 10km']" type="@chance">global.$DATTravelTweaks * 100</add>
	<add sel="/aiscript/attention/actions/do_else[4]/move_to[@object='this.ship']" pos="before">
		<move_to endzone="$locendzone" object="this.ship" destination="$positionspace" uselocalhighways="$canuselocalhighways" abortpath="$abortpath" forcesteering="(not $bigship) and $forcesteering" forceposition="false" forcerotation="true" finishonapproach="false" commandaction="$changecommandaction" chance="(not global.$DATTravelTweaks) * 100">
			<position value="$safepos"/>
			<rotation value="$rotation"/>
		</move_to>
	</add>
	<add sel="/aiscript/attention/actions/do_else[4]/move_to[@object='this.ship'][@destination='$positionspace'][@abortpath='$abortpath'][@endzone='$locendzone'][@forcesteering='(not $bigship) and $forcesteering'][@forceposition='false'][@forcerotation='true'][@commandaction='$changecommandaction'][@uselocalhighways='$canuselocalhighways'][@finishonapproach='false'][2]" type="@travel">this.assignedcontrolled.distanceto.[$positionspace, $safepos] gt 10km</add>
	<add sel="/aiscript/attention/actions/do_else[4]/move_to[@object='this.ship'][@destination='$positionspace'][@abortpath='$abortpath'][@endzone='$locendzone'][@forcesteering='(not $bigship) and $forcesteering'][@forceposition='false'][@forcerotation='true'][@commandaction='$changecommandaction'][@travel='this.assignedcontrolled.distanceto.[$positionspace, $safepos] gt 10km']" type="@chance">global.$DATTravelTweaks * 100</add>
</diff>
