<?xml version='1.0' encoding='utf-8'?>
<diff>
  <replace sel="/aiscript/order[@id='MiningRoutine'][@name='{1041, 341}']/params/param[@name='minbuy']/input_param[@name='max'][@value='[([@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3) - 1, 0].max']/@value">if @this.ship.commander.isclass.[class.station, class.buildstorage] then ([([@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3) - 1, 0].max) else ([([@this.assignedcontrolled.commander.tradenpc.skill.management, @this.assignedcontrolled.commander.pilot.skill.management, @this.assignedcontrolled.pilot.skill.piloting].max),12].max - 1)</replace>
  <replace sel="/aiscript/order[@id='MiningRoutine'][@name='{1041, 341}']/params/param[@name='maxbuy']/input_param[@name='max'][@value='[@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3']/@value">if @this.ship.commander.isclass.[class.station, class.buildstorage] then ([@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3) else ([([@this.assignedcontrolled.commander.tradenpc.skill.management, @this.assignedcontrolled.commander.pilot.skill.management, @this.assignedcontrolled.pilot.skill.piloting].max),12].max)</replace>
  <replace sel="/aiscript/order[@id='MiningRoutine'][@name='{1041, 341}']/params/param[@name='minsell']/input_param[@name='max'][@value='[([@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3) - 1, 0].max']/@value">if @this.ship.commander.isclass.[class.station, class.buildstorage] then ([([@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3) - 1, 0].max) else ([([@this.assignedcontrolled.commander.tradenpc.skill.management, @this.assignedcontrolled.commander.pilot.skill.management, @this.assignedcontrolled.pilot.skill.piloting].max),12].max - 1)</replace>
  <replace sel="/aiscript/order[@id='MiningRoutine'][@name='{1041, 341}']/params/param[@name='maxsell']/input_param[@name='max'][@value='[@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3']/@value">if @this.ship.commander.isclass.[class.station, class.buildstorage] then ([@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3) else ([([@this.assignedcontrolled.commander.tradenpc.skill.management, @this.assignedcontrolled.commander.pilot.skill.management, @this.assignedcontrolled.pilot.skill.piloting].max),12].max)</replace>
  <replace sel="/aiscript/order[@id='MiningRoutine'][@name='{1041, 341}']/params/param[@name='effectiveskill']/@default">if @this.ship.commander.isclass.[class.station, class.buildstorage] then (this.ship.combinedskill) else 100</replace>
  <replace sel="/aiscript/init/do_if[@value='this.isplayerowned']/set_value[@name='$maxrange'][@exact='[@this.assignedcontrolled.commander.tradenpc.skill.management, @this.skill.piloting].max / 3']/@exact">if @this.ship.commander.isclass.[class.station, class.buildstorage] then ([@this.assignedcontrolled.commander.tradenpc.skill.management, @this.skill.piloting].max / 3) else ([([@this.assignedcontrolled.commander.tradenpc.skill.management, @this.assignedcontrolled.commander.pilot.skill.management, @this.assignedcontrolled.pilot.skill.piloting].max),12].max)</replace>
  <remove sel="/aiscript/init/do_if[@value='this.isplayerowned']/do_if[@value='$effectiveskill == 100']"/>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='not @$tradeorder.exists']/do_if[@value='this.assignedcontrolled.cargo.count']/do_if[@value='not this.isplayerowned']/@value">(not this.isplayerowned) or ((this.assignedcontrolled.cargo.free.all)f / this.assignedcontrolled.cargo.capacity.all le 0.5)</replace>
  <remove sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='not @$tradeorder.exists']/do_if[@value='this.assignedcontrolled.cargo.count']/do_if[@value='(not this.isplayerowned) or ((this.assignedcontrolled.cargo.free.all)f / this.assignedcontrolled.cargo.capacity.all le 0.5)']/do_all[@exact='$warebasket.count']/do_if[@value='$maxamount']/drop_cargo[@ware='$possibleware'][@min='($maxamount * 0.1f)i'][@max='($maxamount * 0.2f)i']/@min"/>
  <remove sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='not @$tradeorder.exists']/do_if[@value='this.assignedcontrolled.cargo.count']/do_if[@value='(not this.isplayerowned) or ((this.assignedcontrolled.cargo.free.all)f / this.assignedcontrolled.cargo.capacity.all le 0.5)']/do_all[@exact='$warebasket.count']/do_if[@value='$maxamount']/drop_cargo[@ware='$possibleware'][@max='($maxamount * 0.2f)i']/@max"/>
  <add sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='not @$tradeorder.exists']/do_if[@value='this.assignedcontrolled.cargo.count']/do_if[@value='(not this.isplayerowned) or ((this.assignedcontrolled.cargo.free.all)f / this.assignedcontrolled.cargo.capacity.all le 0.5)']/do_all[@exact='$warebasket.count']/do_if[@value='$maxamount']/drop_cargo[@ware='$possibleware']" type="@exact">$maxamount</add>
</diff>
