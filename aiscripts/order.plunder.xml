<?xml version='1.0' encoding='utf-8'?>
<diff>
  <add sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='$targetzone.policefaction']/do_if[@value='this.assignedcontrolled.owner.relationto.{$targetzone.policefaction} lt 0']/do_if[@value='not this.assignedcontrolled.boardingoperations.count and ((this.attention lt attention.visible) or this.assignedcontrolled.dock or this.isplayerowned)']" pos="before">
    <find_gravidar_contact name="$enemy" object="this.assignedcontrolled" class="class.ship" docked="false" functional="true" masstraffic="false" maybeattackedby="this.assignedcontrolled" multiple="false">
      <match_context macro="this.sector.macro"/>
      <match_distance object="this.assignedcontrolled" max="this.assignedcontrolled.currentradarrange"/>
      <match class="class.buildstorage" negate="true"/>
      <match state="componentstate.wreck" negate="true"/>
    </find_gravidar_contact>
  </add>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='$targetzone.policefaction']/do_if[@value='this.assignedcontrolled.owner.relationto.{$targetzone.policefaction} lt 0']/do_if[@value='not this.assignedcontrolled.boardingoperations.count and ((this.attention lt attention.visible) or this.assignedcontrolled.dock or this.isplayerowned)']/@value">not this.assignedcontrolled.boardingoperations.count and ((this.attention lt attention.visible) or this.assignedcontrolled.dock or this.isplayerowned) and (not @$enemy)</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='$targetzone.policefaction']/do_if[@value='this.assignedcontrolled.owner.relationto.{$targetzone.policefaction} lt 0']/do_else/create_order/param[@name='attacker'][@value='player.ship']/@value">$enemy</replace>
  <add sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='$targetzone.policefaction']/do_if[@value='this.assignedcontrolled.owner.relationto.{$targetzone.policefaction} lt 0']">
    <remove_value name="$enemy"/>
  </add>
</diff>
