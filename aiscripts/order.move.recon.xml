<?xml version='1.0' encoding='utf-8'?>
<diff>
  <replace sel="/aiscript/interrupts/library/actions[@name='FindTargetspace_Police']/do_if[@value='$police']/do_if[@value='not $targetspace or (@$targetspace.policefaction != this.trueowner)']/do_if[@value='not $targetspace']/do_else/do_elseif[@value='this.trueowner != faction.khaak']/@chance">0</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_else[2]/do_if[@value='not $targetspace.isclass.zone']/do_for_each[@name='$loczone']/do_if[@value='$loczone.distanceto.[$loczone.sector, $loczone.sector.coreposition] gt $loczone.sector.coresize / 2m']/@chance">0</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='$blindtourist']/find_closest_undiscovered_position/@range">[this.assignedcontrolled.maxradarrange * 5,$radius / 4].max</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='$blindtourist']/find_closest_undiscovered_position/@chance">100</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='not $resourcescout or not @$list_potentialtargets.count']/do_if[@value='this.ship.distanceto.[$destination, $safepos] gt (this.ship.maxspeed * 60)']/@value">this.assignedcontrolled.distanceto.[$destination, $safepos] gt (this.assignedcontrolled.maxspeed * 30)</replace>
  <add sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='@$localtarget']/do_while[@value='($resourcescout and $localtarget.exists and (not $time_scandone? or player.age lt $time_scandone)) or ($localtarget.isoperational and (not $time_scandone? or player.age lt $time_scandone) and (not @$localtarget.order or $localtarget.order.state != orderstate.critical) and (not @$localtarget.pilot.command or $localtarget.pilot.command.value != command.attackenemies or $localtarget.pilot.command.value != command.attackobject))']/do_else/do_if[@value='$police']/do_if[@value='not @$localtarget.dock and (not @$localtarget.pilot.$donotscan) and (not $localtarget.zone.isclass.highway) and (not $localtarget.pilot.$haltedby? or @$localtarget.pilot.$haltedby == this.assignedcontrolled)']/do_if[@value='$localtarget == player.occupiedship']" pos="before">
    <signal_objects object="$localtarget" param="'LoseCover'" param2="true" chance="if $localtarget.coverowner then 100 else 0"/>
  </add>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='@$localtarget']/do_if[@value='$localtarget.isoperational and ($trouble? or (not $break? and $time_scandone? and player.age ge $time_scandone))']/do_if[@value='$police and (this.owner != faction.paranid) and (this.owner != faction.holyorder) and (this.owner != faction.trinity) and not this.isplayerowned']/do_if[@value='$localtarget.isclass.station and ($localtarget.trueowner == faction.hatikvah or $localtarget.trueowner == faction.scaleplate)']/set_value[@name='$reportchance'][@exact='10']/@exact">100</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='@$localtarget']/do_if[@value='$localtarget.isoperational and ($trouble? or (not $break? and $time_scandone? and player.age ge $time_scandone))']/do_if[@value='$police and (this.owner != faction.paranid) and (this.owner != faction.holyorder) and (this.owner != faction.trinity) and not this.isplayerowned']/do_else/set_value[@name='$reportchance'][@exact='this.combinedskill']/@exact">100</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='@$localtarget']/do_if[@value='$localtarget.isoperational and ($trouble? or (not $break? and $time_scandone? and player.age ge $time_scandone))']/do_if[@value='$localtarget.exists and this.mayattack.{$localtarget}']/do_elseif[@value='$localtarget.isclass.ship_m']/set_value[@name='$table_factionthreatlevels.{$localtarget.owner}'][@exact='@$table_factionthreatlevels.{$localtarget.owner} + 3']/@exact">@$table_factionthreatlevels.{$localtarget.owner} + (if (($localtarget.primarypurpose == purpose.fight) or ($localtarget.primarypurpose == purpose.auxiliary)) then 3 else 1)</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='@$localtarget']/do_if[@value='$localtarget.isoperational and ($trouble? or (not $break? and $time_scandone? and player.age ge $time_scandone))']/do_if[@value='$localtarget.exists and this.mayattack.{$localtarget}']/do_elseif[@value='$localtarget.isclass.ship_l']/set_value[@name='$table_factionthreatlevels.{$localtarget.owner}'][@exact='@$table_factionthreatlevels.{$localtarget.owner} + 11']/@exact">@$table_factionthreatlevels.{$localtarget.owner} + (if (($localtarget.primarypurpose == purpose.fight) or ($localtarget.primarypurpose == purpose.auxiliary)) then 11 else 3)</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='@$localtarget']/do_if[@value='$localtarget.isoperational and ($trouble? or (not $break? and $time_scandone? and player.age ge $time_scandone))']/do_if[@value='$localtarget.exists and this.mayattack.{$localtarget}']/do_elseif[@value='$localtarget.isclass.ship_xl']/set_value[@name='$table_factionthreatlevels.{$localtarget.owner}'][@exact='@$table_factionthreatlevels.{$localtarget.owner} + 23']/@exact">@$table_factionthreatlevels.{$localtarget.owner} + (if (($localtarget.primarypurpose == purpose.fight) or ($localtarget.primarypurpose == purpose.auxiliary)) then 23 else 11)</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='@$localtarget']/do_if[@value='$localtarget.isoperational and ($trouble? or (not $break? and $time_scandone? and player.age ge $time_scandone))']/do_if[@value='$localtarget.exists and this.mayattack.{$localtarget}']/do_elseif[@value='$localtarget.isclass.station']/set_value[@name='$table_factionthreatlevels.{$localtarget.owner}'][@exact='@$table_factionthreatlevels.{$localtarget.owner} + 10']/@exact">@$table_factionthreatlevels.{$localtarget.owner} + [46, $localtarget.weapons.operational.count].max</replace>
  <remove sel="/aiscript/attention[@min='unknown']/actions/do_if[@value='@$localtarget']/do_if[@value='$localtarget.isoperational and ($trouble? or (not $break? and $time_scandone? and player.age ge $time_scandone))']/do_if[@value='$localtarget.exists and this.mayattack.{$localtarget}']/do_elseif[@value='$localtarget.isclass.station']/set_value[@name='$table_factionthreatlevels.{$localtarget.owner}'][@exact='@$table_factionthreatlevels.{$localtarget.owner} + [46, $localtarget.weapons.operational.count].max']/@chance"/>
</diff>
