<?xml version='1.0' encoding='utf-8'?>
<diff>
  <replace sel="/aiscript/interrupts/library/actions[@name='FindTargetspace_Police']/do_if[@value='$police']/do_if[@value='not $targetspace or (@$targetspace.policefaction != this.trueowner)']/do_if[@value='not $targetspace']/do_else/do_elseif[@value='this.trueowner != faction.khaak']/@chance">if global.$DATPatrolTweaks then 0 else (if (this.trueowner == faction.ministry) or (this.trueowner == faction.teladi) then 100 else 20)</replace>
  <replace sel="/aiscript/attention/actions/do_else[2]/do_if[@value='not $targetspace.isclass.zone']/do_for_each[@name='$loczone']/do_if[@value='$loczone.distanceto.[$loczone.sector, $loczone.sector.coreposition] gt $loczone.sector.coresize / 2m']/@chance">if global.$DATPatrolTweaks then 0 else 90</replace>
  <add sel="/aiscript/attention/actions/do_if[@value='$blindtourist']/find_closest_undiscovered_position" pos="before">
    <find_closest_undiscovered_position result="$pos_target" sector="$targetspace" range="this.ship.maxradarrange * 2" chance="if (not global.$DATPatrolTweaks) then this.assignedcontrolled.combinedskill else 0">
      <position value="$targetspace.coreposition"/>
      <rangecenter object="this.assignedcontrolled"/>
    </find_closest_undiscovered_position>
  </add>
  <replace sel="/aiscript/attention/actions/do_if[@value='$blindtourist']/find_closest_undiscovered_position[@result='$pos_target'][@sector='$targetspace'][@range='this.ship.maxradarrange * 2'][@chance='this.assignedcontrolled.combinedskill']/@range">$radius</replace>
  <replace sel="/aiscript/attention/actions/do_if[@value='$blindtourist']/find_closest_undiscovered_position[@result='$pos_target'][@sector='$targetspace'][@range='$radius']/@chance">if global.$DATPatrolTweaks then 100 else 0</replace>
  <add sel="/aiscript/attention/actions/do_if[@value='@$localtarget']/do_while[@value='($resourcescout and $localtarget.exists and (not $time_scandone? or player.age lt $time_scandone)) or ($localtarget.isoperational and (not $time_scandone? or player.age lt $time_scandone) and (not @$localtarget.order or $localtarget.order.state != orderstate.critical) and (not @$localtarget.pilot.command or $localtarget.pilot.command.value != command.attackenemies or $localtarget.pilot.command.value != command.attackobject))']/do_else/do_if[@value='$police']/do_if[@value='not @$localtarget.dock and (not @$localtarget.pilot.$donotscan) and (not $localtarget.zone.isclass.highway) and (not $localtarget.pilot.$haltedby? or @$localtarget.pilot.$haltedby == this.assignedcontrolled)']/do_if[@value='$localtarget == player.occupiedship']" pos="before">
    <signal_objects object="$localtarget" param="'LoseCover'" param2="true" chance="(global.$DATPatrolTweaks and @$localtarget.coverowner) * 100"/>
  </add>
  <add sel="/aiscript/attention/actions/do_if[@value='@$localtarget']/do_if[@value='$localtarget.isoperational and ($trouble? or (not $break? and $time_scandone? and player.age ge $time_scandone))']/do_if[@value='$police and (this.owner != faction.paranid) and (this.owner != faction.holyorder) and (this.owner != faction.trinity) and not this.isplayerowned']/do_if[@value='$localtarget.isclass.station and ($localtarget.trueowner == faction.hatikvah or $localtarget.trueowner == faction.scaleplate)']/set_value[@name='$reportchance'][@exact='10']" type="@chance">(not global.$DATPatrolTweaks) * 100</add>
  <add sel="/aiscript/attention/actions/do_if[@value='@$localtarget']/do_if[@value='$localtarget.isoperational and ($trouble? or (not $break? and $time_scandone? and player.age ge $time_scandone))']/do_if[@value='$police and (this.owner != faction.paranid) and (this.owner != faction.holyorder) and (this.owner != faction.trinity) and not this.isplayerowned']/do_else/set_value[@name='$reportchance'][@exact='this.combinedskill']" type="@chance">(not global.$DATPatrolTweaks) * 100</add>
</diff>
