<?xml version='1.0' encoding='utf-8'?>
<diff>
  <remove sel="/aiscript/init/set_value[@name='$scantime'][@exact='500ms + ((1.0 - (@this.assignedcontrolled.combinedskill / 100.0)) * 60s)']/@exact"/>
  <add sel="/aiscript/init/set_value[@name='$scantime']" type="@min">500ms</add>
  <add sel="/aiscript/init/set_value[@name='$scantime'][@min='500ms']" type="@max">1s</add>
  <remove sel="/aiscript/attention[@min='visible']/actions/set_value[@name='$scantime'][@exact='500ms + ((1.0 - (@this.assignedcontrolled.combinedskill / 100.0)) * 60s)']/@exact"/>
  <add sel="/aiscript/attention[@min='visible']/actions/set_value[@name='$scantime']" type="@min">500ms</add>
  <add sel="/aiscript/attention[@min='visible']/actions/set_value[@name='$scantime'][@min='500ms']" type="@max">1s</add>
  <replace sel="/aiscript/attention[@min='visible']/actions/do_if[@value='@$allowothertargets or $turretmodes.indexof.{weaponmode.attackenemies} or $turretmodes.indexof.{weaponmode.attackcapital} or $turretmodes.indexof.{weaponmode.attackfighters} or ($defencedronemode == dronemode.attackenemies and this.assignedcontrolled.hasarmeddefencedrones)']/do_if[@value='this.sector']/find_gravidar_contact/match_distance[@max='this.ship.maxcombatrange.all * 2']/@max">this.assignedcontrolled.maxradarrange</replace>
  <replace sel="/aiscript/attention[@min='visible']/actions/do_if[@value='this.ship.pilot and (@$targets.count or $dronetargets.count or ($miningtargets.count and this.ship == player.occupiedship))']/do_if[@value='@$primarytarget.canbeattacked']/do_elseif[@value='(this.assignedcontrolled != player.occupiedship) and not this.assignedcontrolled.dock']/shoot_at[@largetarget='$largetarget'][@tolerance='10.0deg']/@tolerance">4.0deg</replace>
  <replace sel="/aiscript/attention[@min='visible']/actions/do_if[@value='this.ship.pilot and (@$targets.count or $dronetargets.count or ($miningtargets.count and this.ship == player.occupiedship))']/do_if[@value='@$primarytarget.canbeattacked']/do_elseif[@value='(this.assignedcontrolled != player.occupiedship) and not this.assignedcontrolled.dock']/shoot_at[@largetarget='$largetarget'][@tolerance='360.0deg']/@tolerance">if $largetarget then 8.0deg else 4.0deg</replace>
  <replace sel="/aiscript/attention[@min='visible']/actions/do_if[@value='this.ship.pilot and (@$targets.count or $dronetargets.count or ($miningtargets.count and this.ship == player.occupiedship))']/do_if[@value='$dronetargets.count and not this.$launchedunitcount? and this.assignedcontrolled.units.{unitcategory.defence}.count and not this.assignedcontrolled.zone.isclass.highway and not this.assignedcontrolled.travel.active']/do_if[@value='not $donotlaunchdefencedrones? and this.assignedcontrolled.hasarmeddefencedrones']/do_if[@value='player.age'][@min='$lastdronelaunch + 500ms + ((1.0 - (this.assignedcontrolled.combinedskill / 100.0)) * 60s)']/@min">$lastdronelaunch + 1s</replace>
  <replace sel="/aiscript/attention[@min='visible']/actions/do_if[@value='this.ship.pilot and (@$targets.count or $dronetargets.count or ($miningtargets.count and this.ship == player.occupiedship))']/do_if[@value='$dronetargets.count and not this.$launchedunitcount? and this.assignedcontrolled.units.{unitcategory.defence}.count and not this.assignedcontrolled.zone.isclass.highway and not this.assignedcontrolled.travel.active']/do_if[@value='not $donotlaunchdefencedrones? and this.assignedcontrolled.hasarmeddefencedrones']/do_if[@value='player.age'][@min='$lastdronelaunch + 1s']/set_value[@name='$maxnum_dronespersquad'][@exact='[[@this.ship.pilot.skill.piloting / 3, 1].max, this.ship.availableunits.{unitcategory.defence}.count].min']/@exact">[5, this.assignedcontrolled.availableunits.{unitcategory.defence}.count].min</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_while[@value='this.ship.pilot and @$targets_defensibles.count and this.sector']/do_all[@exact='$targets_defensibles.count']/do_if[@value='not @$maxtargets']/set_value[@name='$maxtargets'][@exact='[this.ship.turrets.operational.count, $targets_defensibles.count, [this.assignedcontrolled.combinedskill / 5, 3].max].min']/@exact">[this.assignedcontrolled.turrets.operational.count, $targets_defensibles.count].min</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_while[@value='this.ship.pilot and @$targets_defensibles.count and this.sector']/do_all[@exact='$targets_defensibles.count']/do_if[@value='not @$maxtargets']/set_value[@name='$maxtargets'][@min='1'][@max='$maxtargets']/@max">[$maxtargets,1].max</replace>
  <replace sel="/aiscript/attention[@min='unknown']/actions/do_while[@value='this.ship.pilot and @$targets_defensibles.count and this.sector']/do_all[@exact='$targets_defensibles.count']/do_if[@value='not $attackchance?']/set_value[@name='$attackchance'][@exact='[this.assignedcontrolled.combinedskill, 90].max']/@exact">[100, 90].random</replace>
</diff>
