Attack AI tweaks
https://www.nexusmods.com/x4foundations/mods/839
by kuertee

Updates
=======
v5.0.0012, 25 Mar 2022:
-Note: This version will invalidate the mod's attack behaviours from the previous version, causing the ships to act unexpectedly UNTIL their next AI cycle. Or you can simply cancel then reissue any attack orders.
-New feature: L, and XL ships will now start their attack at their max combat range. Prevously, they started their attack at their optimal combat range - which made it look like they ignored their long-range weapons. As in previous versions, they'll inch towards their optimal combat range.
-New feature: L, and XL ships will approach their target at a vertical angle. Previously, they approached their target at their target's vertical position.
-New feature: XS (except for drones), S, and M ships will circle high-risk targets at a vertical angle.
-Bug-fix: L, and XL ships were still trying to get to the other side of their targets - exposing themselves to their target's weapons as they passed them. This happened when the ship acquired an attack order against the same target and the target is outside combat range. I.e. the ship only acquired the "stop kamikaze" behaviour once per target in previous version. In this version, this doesn't happen. (I had to rewrite how the mod's internal data for an attack order was stored for this fix.)
-New feature: L, and XL ships will move away a short distance after destroying a station module for a better attack vector against their next module target. They'll use the mod's behaviour for avoiding high-risk enemies so that they don't get within range of the station's turrets.
-New feature: High-risk enemies are no longer determined on object class. Potentially high-risk enemies are 1.5x larger physically than the ship. For XS (except for drones), S, and M ships, high-risk enemies have turrets that outnumber the attackers. For L, and XL ships, high-risk enemies have more DPS than the ship.

Mod effects
===========
(1) All ships avoid high-risk enemies. (2) L, and XL ships inch forward against high-risk targets. (3) L, and XL ships withdraw from high-risk targets when their shields fall below 90%.

Requirements
============
-SirNukes Mod Support APIs mod (https://www.nexusmods.com/x4foundations/mods/503)

Recommended companion mod
=========================
-DeadAirAITweaks mod: https://github.com/DeadAirRT/deadairaitweaks

Avoid high-risk enemies
=======================
All ships move around high-risk enemies that are in their flight path. (https://youtu.be/mWBef0_mrmE)

XS (except for drones), S, and M class ships will circle high-risk targets until they outnumber 75% of their targets' turrets. Ships with missile and torpedo loadouts do not acquire this behaviour until their missiles and torpedoes are depleted. (https://youtu.be/DFVtwZxSKes)

L, and XL class ships, enroute to their targets, will stop short of their targets to prevent accidental kamikaze attacks.

L, and XL AI behaviours
=======================
Creep forward: When attacking high-risk targets, L and XL ships will move forward from near their max range up to an optimal range based on the times they withdrew and the times they didn't have to withdraw. The player's removal of high-damage turrets have a direct effect on the AI's behaviour.

Previous versions start at their optimal range based on their DPS, their target DPS and the number of times they withdrew. You can enable this previous version in the Extension Options.

The current version makes use of long-range weapons earlier and for a longer time - softening up their target. The previous version used all weapons sooner (because they get closer sooner) but put the ship in danger sooner - causing some ships to withdraw sooner and more often.

Withdraw out of range: When shields drop below 90%, L and XL ships will withdraw out of range at a distance based on their remaining shields. They withdraw farther with lower shields to give it time to recharge.

Player-owned ships only
=======================
By default, these AI behaviours are applied to player-owned ships only. But you can enable them for ALL ships. Note that I've not tested them on all ships.

High-risk enemies
=================
Potentially high-risk enemies are 1.5x larger physically than the ship. For XS (except for drones), S, and M ships, high-risk enemies have turrets that outnumber the attackers. For L, and XL ships, high-risk enemies have more DPS than the ship.

What this mod doesn't do
========================
1. Order fleet subordinates to attack. Fleet subordinates only acquire this mod's attack behaviours WHEN they acquire an attack order from either their commander or the player. This mod will never start their attacks. How they behave at the start of their attack, defend and intercept stances are determined by their AI commander's orders.
2. For XS, S, and M ships: set their starting targets. The only time this mod sets targets for S, and M ships are when they are circling a high-risk enemy AND their "Attack all enemies" option is enabled.
3. For L, and XL ships: set their targets.
4. Find and move to the best attack vector. (Nor did the base attack AI.) Ships that are in "ideal" attack vectors are incidental. (Same with the base attack AI.)
5. Increase the efficiency of attacks in low attention. Damages received and dealt in attacks in low attention are determined by the base game. I.e. ships could be in good attack ranges (and out of reach of their target's weapons) but still not deal the optimal damage per second.

Install:
========
-Unzip to 'X4 Foundations/extensions/kuertee_attack_ai_tweaks/'.
-Make sure the sub-folders, and files are in 'X4 Foundations/extensions/kuertee_attack_ai_tweaks/', and not in 'X4 Foundations/extensions/kuertee_attack_ai_tweaks/kuertee_attack_ai_tweaks/'.

Uninstall:
==========
-Delete the mod folder.

Credits
=======
By kuertee.

History:
========
v5.0.0011, 19 Mar 2022:
-Bug-fix: Capital ships were still trying to find better attack vectors at the other side of their target stations.
-Tweak: Better optimal range values.
-Bug-fix: Some of the new behaviours were getting applied to ALL ships even if that option is disabled in the Extension Options.
-Tweak: Cleaned-up some unnecessary get_safe_pos calls.

v5.0.001, 17 Mar 2022:
-New feature: "Enable/Disable: 'Attack all enemies'" Interact Menu (i.e. right-click context sensitive menu) to enable or disable the "Attack all enemies" options of any attack orders of the selected ships.
-New feature: XS (except for drones), S, and M ships with missiles and torpedoes are do not use their avoidance AI until their missiles and torpedoes are exhausted.
-New feature: L and XL ships will never use boost against stations - except when their base-game AI makes them use their boost to flee.
-New feature: Disables the base-game AI that allows L and XL ships to look for better attack vectors on the other side of their target stations (ignoring the danger of passing by the main body of the station).
-New feature: L and XL module targets are shown on the map.
-Tweak: More careful "inch forward" and better withdraw AI.
-Tweak: Better "move around" vectors.

v4.2.0810, 12 Mar 2022:
-Initial release.
